/*! 
 Build based on gin-vue-admin 
 Time : 1696555582000 */
import{a as e,o as a,h as l,w as t,d as s,b as o,g as r,c as i,M as n,N as u,G as m,t as p,a4 as c,k as d,l as g,E as v,J as y}from"./index-33d179e9.js";import{E as f}from"./drawer-2bb1458e.js";import"./overlay-848c174d.js";import{E as j}from"./pagination-a4874b9b.js";/* empty css              */import"./tag-0f8d4dae.js";import"./select-a26e10b7.js";import"./scrollbar-81bf16b6.js";/* empty css               */import{E as b}from"./image-viewer-e9617930.js";/* empty css             */import{a as _,E as k}from"./form-item-8ffdb63e.js";/* empty css               */import{_ as x,U as h,a as C,g as w,e as z}from"./common-05cccbcb.js";import{_ as U}from"./warningBar-6b10fcc0.js";const S={class:"gva-btn-list"},V={class:"media"},E={class:"header-img-box-list"},B={class:"header-img-box-list"},I=o("picture",null,null,-1),O=["onClick"],K={__name:"index",props:{target:{type:Object,default:null},targetKey:{type:String,default:""}},emits:["enterImg"],setup(K,{expose:M,emit:T}){const D=e(""),F=e(""),G=e({}),J=e(1),N=e(0),P=e(20),W=e=>{P.value=e,$()},X=e=>{J.value=e,$()},Y=e(!1),Z=e([]),$=async()=>{const e=await w({page:J.value,pageSize:P.value,...G.value});0===e.code&&(Z.value=e.data.list,N.value=e.data.total,J.value=e.data.page,P.value=e.data.pageSize,Y.value=!0)};return M({open:$}),(e,w)=>{const M=g,q=_,A=v,H=k,L=y,Q=b,R=j,ee=f;return a(),l(ee,{modelValue:Y.value,"onUpdate:modelValue":w[3]||(w[3]=e=>Y.value=e),title:"媒体库",size:"650px"},{default:t((()=>[s(U,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),o("div",S,[s(x,{imageCommon:F.value,"onUpdate:imageCommon":w[0]||(w[0]=e=>F.value=e),class:"upload-btn-media-library",onOnSuccess:$},null,8,["imageCommon"]),s(h,{imageUrl:D.value,"onUpdate:imageUrl":w[1]||(w[1]=e=>D.value=e),"file-size":512,"max-w-h":1080,class:"upload-btn-media-library",onOnSuccess:$},null,8,["imageUrl"]),s(H,{ref:"searchForm",inline:!0,model:G.value},{default:t((()=>[s(q,{label:""},{default:t((()=>[s(M,{modelValue:G.value.keyword,"onUpdate:modelValue":w[2]||(w[2]=e=>G.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),s(q,null,{default:t((()=>[s(A,{type:"primary",icon:"search",onClick:$},{default:t((()=>[r("查询")])),_:1})])),_:1})])),_:1},8,["model"])]),o("div",V,[(a(!0),i(n,null,u(Z.value,((e,r)=>(a(),i("div",{key:r,class:"media-box"},[o("div",E,[(a(),l(Q,{key:r,src:m(C)(e.url),onClick:a=>{return l=e.url,t=K.target,s=K.targetKey,t&&s&&(t[s]=l),T("enterImg",l),void(Y.value=!1);var l,t,s}},{error:t((()=>[o("div",B,[s(L,null,{default:t((()=>[I])),_:1})])])),_:2},1032,["src","onClick"]))]),o("div",{class:"img-title",onClick:a=>(async e=>{c.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await z(e)).code&&(d({type:"success",message:"编辑成功!"}),$())})).catch((()=>{d({type:"info",message:"取消修改"})}))})(e)},p(e.name),9,O)])))),128))]),s(R,{"current-page":J.value,"page-size":P.value,total:N.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:X,onSizeChange:W},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])}}};export{K as _};
