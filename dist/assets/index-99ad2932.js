/*! 
 Build based on gin-vue-admin 
 Time : 1697152884000 */
import{a as e,o as a,h as l,w as t,d as s,b as o,g as r,c as i,M as n,N as u,G as m,t as p,a4 as c,k as d,l as v,E as g,J as y}from"./index-37934f2a.js";import{E as f}from"./drawer-5d4a85a4.js";import"./overlay-93d44909.js";import{E as j}from"./pagination-fb011907.js";/* empty css              */import"./tag-eed7c3b2.js";import"./select-6545c62b.js";import"./scrollbar-b6c70f3e.js";/* empty css               */import{E as b}from"./image-viewer-4ea3a463.js";/* empty css             */import{a as _,E as x}from"./form-item-0ef09b87.js";/* empty css               */import{_ as h,U as k,a as C,g as w,e as U}from"./common-25e920c5.js";import{_ as z}from"./warningBar-582ed635.js";const E={class:"gva-btn-list"},S={class:"media"},V={class:"header-img-box-list"},B={class:"header-img-box-list"},O=o("picture",null,null,-1),I=["onClick"],J={__name:"index",props:{target:{type:Object,default:null},targetKey:{type:String,default:""}},emits:["enterImg"],setup(J,{expose:K,emit:M}){const T=e(""),A=e(""),F=e({}),G=e(1),N=e(0),P=e(20),X=e=>{P.value=e,q()},Y=e=>{G.value=e,q()},Z=e(!1),$=e([]),q=async()=>{const e=await w({page:G.value,pageSize:P.value,...F.value});0===e.code&&($.value=e.data.list,N.value=e.data.total,G.value=e.data.page,P.value=e.data.pageSize,Z.value=!0)};return K({open:q}),(e,w)=>{const K=v,D=_,H=g,L=x,Q=y,R=b,W=j,ee=f;return a(),l(ee,{modelValue:Z.value,"onUpdate:modelValue":w[3]||(w[3]=e=>Z.value=e),title:"媒体库",size:"650px"},{default:t((()=>[s(z,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),o("div",E,[s(h,{imageCommon:A.value,"onUpdate:imageCommon":w[0]||(w[0]=e=>A.value=e),class:"upload-btn-media-library",onOnSuccess:q},null,8,["imageCommon"]),s(k,{imageUrl:T.value,"onUpdate:imageUrl":w[1]||(w[1]=e=>T.value=e),"file-size":512,"max-w-h":1080,class:"upload-btn-media-library",onOnSuccess:q},null,8,["imageUrl"]),s(L,{ref:"searchForm",inline:!0,model:F.value},{default:t((()=>[s(D,{label:""},{default:t((()=>[s(K,{modelValue:F.value.keyword,"onUpdate:modelValue":w[2]||(w[2]=e=>F.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),s(D,null,{default:t((()=>[s(H,{type:"primary",icon:"search",onClick:q},{default:t((()=>[r("查询")])),_:1})])),_:1})])),_:1},8,["model"])]),o("div",S,[(a(!0),i(n,null,u($.value,((e,r)=>(a(),i("div",{key:r,class:"media-box"},[o("div",V,[(a(),l(R,{key:r,src:m(C)(e.url),onClick:a=>{return l=e.url,t=J.target,s=J.targetKey,t&&s&&(t[s]=l),M("enterImg",l),void(Z.value=!1);var l,t,s}},{error:t((()=>[o("div",B,[s(Q,null,{default:t((()=>[O])),_:1})])])),_:2},1032,["src","onClick"]))]),o("div",{class:"img-title",onClick:a=>(async e=>{c.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await U(e)).code&&(d({type:"success",message:"编辑成功!"}),q())})).catch((()=>{d({type:"info",message:"取消修改"})}))})(e)},p(e.name),9,I)])))),128))]),s(W,{"current-page":G.value,"page-size":P.value,total:N.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:Y,onSizeChange:X},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])}}};export{J as _};
