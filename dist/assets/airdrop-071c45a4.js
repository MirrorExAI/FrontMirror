/*! 
 Build based on gin-vue-admin 
 Time : 1697372399000 */
import{a as e,X as a,o as l,c as t,b as o,d as i,w as r,g as s,t as u,G as d,h as p,e as n,aJ as m,aK as c,k as v,aL as g,aM as h,aN as f,l as y,E as b}from"./index-f8b29c45.js";import{E as w}from"./dialog-8c51370b.js";import"./overlay-1393c107.js";import{E as _}from"./switch-339dd5ea.js";import{E as j}from"./radio-6f74146d.js";/* empty css              *//* empty css               */import"./tag-373c9951.js";import"./checkbox-0d40d18f.js";import"./scrollbar-c461322d.js";import{E as k}from"./pagination-c993fc24.js";import{E as V,a as I}from"./select-b1bc1c88.js";import{E as x,a as C}from"./table-column-c56acf44.js";/* empty css                */import{E as U}from"./popover-f2b01d49.js";import{a as N,E as D}from"./form-item-b45927e2.js";/* empty css               */import{g as E}from"./authority-4d2845b3.js";import"./image-viewer-aa3b6ca9.js";/* empty css                                                              */import{_ as z}from"./index-49b79aec.js";/* empty css             */import{a as S,f as q}from"./format-10da63a7.js";import"./rand-099990c4.js";import"./strings-594f22a4.js";import"./isEqual-914bba85.js";import"./_Uint8Array-b6bd5a9f.js";import"./cloneDeep-d3c0444a.js";import"./_baseClone-609c4491.js";import"./_initCloneObject-55cd1d54.js";import"./index-c6707ffb.js";import"./index-b83af27e.js";import"./debounce-daeb5e71.js";import"./dropdown-01814423.js";import"./drawer-e2494d53.js";import"./common-08e49c24.js";import"./upload-b036bc64.js";import"./progress-ace5b054.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./warningBar-7e0da863.js";import"./date-225eaf4f.js";import"./dictionary-cb623fa1.js";import"./sysDictionary-a05da767.js";const A={class:"gva-search-box"},F={class:"gva-table-box"},O=["href"],$=o("p",null,"确定要通过吗？",-1),G={style:{"text-align":"right","margin-top":"8px"}},J=o("p",null,"确定要驳回吗？",-1),K={style:{"text-align":"right","margin-top":"8px"}},L={class:"gva-pagination"},M={style:{height:"60vh",overflow:"auto",padding:"0 12px"}},X=["src"],Z={key:1,class:"header-img-box"},B={class:"dialog-footer"},P={name:"User"},Y=Object.assign(P,{setup(P){const Y=e("https://api.bitcoin-wen.com/"),H=(e,a)=>{e&&e.forEach((e=>{if(e.children&&e.children.length){const l={authorityId:e.authorityId,authorityName:e.authorityName,children:[]};H(e.children,l.children),a.push(l)}else{const l={authorityId:e.authorityId,authorityName:e.authorityName};a.push(l)}}))},Q=e(1),R=e(0),T=e(10),W=e([]);e([{value:0,text:""},{value:1,text:"正常"},{value:2,text:"冻结"}]);const ee=e({}),ae=e=>{T.value=e,te()},le=e=>{Q.value=e,te()},te=async()=>{const e=await m({page:Q.value,pageSize:T.value,...ee.value});0===e.code&&(W.value=e.data.list,R.value=e.data.total,Q.value=e.data.page,T.value=e.data.pageSize)};a((()=>W.value),(()=>{oe()}));(async()=>{te();const e=await E({page:1,pageSize:999});ue(e.data.list)})();const oe=()=>{W.value&&W.value.forEach((e=>{e.authorityIds=e.authorities&&e.authorities.map((e=>e.authorityId))}))},ie=e(null),re=()=>{ie.value.open()},se=e([]),ue=e=>{se.value=[],H(e,se.value)},de=e({username:"",password:"",nickName:"",headerImg:"",authorityId:"",authorityIds:[],enable:1}),pe=e({userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,message:"最低5位字符",trigger:"blur"}],password:[{required:!0,message:"请输入用户密码",trigger:"blur"},{min:6,message:"最低6位字符",trigger:"blur"}],nickName:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],phone:[{pattern:/^1([38][0-9]|4[014-9]|[59][0-35-9]|6[2567]|7[0-8])\d{8}$/,message:"请输入合法手机号",trigger:"blur"}],email:[{pattern:/^([0-9A-Za-z\-_.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g,message:"请输入正确的邮箱",trigger:"blur"}],authorityId:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}),ne=e(null),me=async()=>{de.value.authorityId=de.value.authorityIds[0],ne.value.validate((async e=>{if(e){const e={...de.value};if("add"===ge.value){const a=await h(e);0===a.code&&(v({type:"success",message:"请复制Google验证码：   "+a.data.user.googleSecret}),await te(),ve())}if("edit"===ge.value){0===(await f(e)).code&&(v({type:"success",message:"编辑成功"}),await te(),ve())}}}))},ce=e(!1),ve=()=>{ne.value.resetFields(),de.value.headerImg="",de.value.authorityIds=[],ce.value=!1},ge=e("add"),he=()=>{ee.value={}},fe=()=>{Q.value=1,T.value=10,te()};return(e,a)=>{const m=y,h=N,f=V,E=I,P=b,H=D,oe=x,ue=U,ye=C,be=k,we=j,_e=_,je=w;return l(),t("div",null,[o("div",A,[i(H,{ref:"searchForm",inline:!0,model:ee.value},{default:r((()=>[i(h,{align:"left",label:"开始日期",width:"180"},{default:r((()=>[i(m,{modelValue:ee.value.startDate,"onUpdate:modelValue":a[0]||(a[0]=e=>ee.value.startDate=e),type:"date",placeholder:"请选择开始日期"},null,8,["modelValue"])])),_:1}),i(h,{align:"left",label:"结束日期",width:"180"},{default:r((()=>[i(m,{modelValue:ee.value.endDate,"onUpdate:modelValue":a[1]||(a[1]=e=>ee.value.endDate=e),type:"date",placeholder:"请选择开始日期"},null,8,["modelValue"])])),_:1}),i(h,{label:"状态",prop:"status"},{default:r((()=>[i(E,{modelValue:ee.value.type,"onUpdate:modelValue":a[2]||(a[2]=e=>ee.value.type=e),clear:"",placeholder:"请选择"},{default:r((()=>[i(f,{label:"通过",value:"1"}),i(f,{label:"驳回",value:"2"}),i(f,{label:"待处理",value:"0"})])),_:1},8,["modelValue"])])),_:1}),i(h,null,{default:r((()=>[i(P,{type:"primary",icon:"search",onClick:fe},{default:r((()=>[s("查询")])),_:1}),i(P,{icon:"refresh",onClick:he},{default:r((()=>[s("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),o("div",F,[i(ye,{data:W.value,"row-key":"ID"},{default:r((()=>[i(oe,{align:"left",label:"客户ID","min-width":"100",prop:"ID"}),i(oe,{align:"left",label:"业务员","min-width":"100",prop:"agent"}),i(oe,{align:"left",label:"钱包地址","min-width":"180",prop:"address"},{default:r((e=>[o("a",{href:"https://etherscan.io/address/"+e.row.address,target:"_blank"},u(e.row.address),9,O)])),_:1}),i(oe,{align:"left",label:"提取金额","min-width":"150",prop:"reward"}),i(oe,{align:"left",label:"进度",prop:"status",width:"100"},{default:r((e=>[s(u(d(S)(e.row.status)),1)])),_:1}),i(oe,{align:"left",label:"创建日期","min-width":"130",sortable:"custom"},{default:r((e=>[s(u(d(q)(e.row.CreatedAt)),1)])),_:1}),i(oe,{align:"left",label:"操作"},{default:r((e=>[i(ue,{modelValue:e.row.visible,"onUpdate:modelValue":a=>e.row.visible=a,placement:"top",width:"160"},{reference:r((()=>[i(P,{type:"primary",link:"",icon:"edit",style:{"margin-left":"10px"},onClick:a=>e.row.visible=!0},{default:r((()=>[s("通过")])),_:2},1032,["onClick"])])),default:r((()=>[$,o("div",G,[i(P,{type:"primary",link:"",onClick:a=>e.row.visible=!1},{default:r((()=>[s("取消")])),_:2},1032,["onClick"]),i(P,{type:"primary",onClick:a=>(async e=>{e.visible=!1,0===(await c({ID:e.ID})).code&&(v({type:"success",message:"审核成功"}),1===W.value.length&&Q.value>1&&Q.value--,te())})(e.row)},{default:r((()=>[s("确定")])),_:2},1032,["onClick"])])])),_:2},1032,["modelValue","onUpdate:modelValue"]),i(ue,{modelValue:e.row.visible,"onUpdate:modelValue":a=>e.row.visible=a,placement:"top",width:"160"},{reference:r((()=>[i(P,{type:"primary",link:"",icon:"delete",style:{"margin-left":"10px"},onClick:a=>e.row.visible=!0},{default:r((()=>[s("驳回")])),_:2},1032,["onClick"])])),default:r((()=>[J,o("div",K,[i(P,{type:"primary",link:"",onClick:a=>e.row.visible=!1},{default:r((()=>[s("取消")])),_:2},1032,["onClick"]),i(P,{type:"primary",onClick:a=>(async e=>{e.visible=!1,0===(await g({ID:e.ID})).code&&(v({type:"success",message:"驳回成功"}),1===W.value.length&&Q.value>1&&Q.value--,te())})(e.row)},{default:r((()=>[s("驳回")])),_:2},1032,["onClick"])])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"]),o("div",L,[i(be,{"current-page":Q.value,"page-size":T.value,"page-sizes":[10,30,50,100],total:R.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:le,onSizeChange:ae},null,8,["current-page","page-size","total"])])]),i(je,{modelValue:ce.value,"onUpdate:modelValue":a[10]||(a[10]=e=>ce.value=e),title:"用户","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{footer:r((()=>[o("div",B,[i(P,{onClick:ve},{default:r((()=>[s("取 消")])),_:1}),i(P,{type:"primary",onClick:me},{default:r((()=>[s("确 定")])),_:1})])])),default:r((()=>[o("div",M,[i(H,{ref_key:"userForm",ref:ne,rules:pe.value,model:de.value,"label-width":"80px"},{default:r((()=>["add"===ge.value?(l(),p(h,{key:0,label:"用户名",prop:"userName"},{default:r((()=>[i(m,{modelValue:de.value.userName,"onUpdate:modelValue":a[3]||(a[3]=e=>de.value.userName=e)},null,8,["modelValue"])])),_:1})):n("",!0),"add"===ge.value?(l(),p(h,{key:1,label:"密码",prop:"password"},{default:r((()=>[i(m,{modelValue:de.value.password,"onUpdate:modelValue":a[4]||(a[4]=e=>de.value.password=e)},null,8,["modelValue"])])),_:1})):n("",!0),i(h,{label:"昵称",prop:"nickName"},{default:r((()=>[i(m,{modelValue:de.value.nickName,"onUpdate:modelValue":a[5]||(a[5]=e=>de.value.nickName=e)},null,8,["modelValue"])])),_:1}),i(h,{label:"手机号",prop:"phone"},{default:r((()=>[i(m,{modelValue:de.value.phone,"onUpdate:modelValue":a[6]||(a[6]=e=>de.value.phone=e)},null,8,["modelValue"])])),_:1}),i(h,{label:"邮箱",prop:"email"},{default:r((()=>[i(m,{modelValue:de.value.email,"onUpdate:modelValue":a[7]||(a[7]=e=>de.value.email=e)},null,8,["modelValue"])])),_:1}),i(h,{label:"用户角色",prop:"authorityId"},{default:r((()=>[i(we,{modelValue:de.value.authorityIds,"onUpdate:modelValue":a[8]||(a[8]=e=>de.value.authorityIds=e),style:{width:"100%"},options:se.value,"show-all-levels":!1,props:{multiple:!0,checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},clearable:!1},null,8,["modelValue","options"])])),_:1}),i(h,{label:"启用",prop:"disabled"},{default:r((()=>[i(_e,{modelValue:de.value.enable,"onUpdate:modelValue":a[9]||(a[9]=e=>de.value.enable=e),"inline-prompt":"","active-value":1,"inactive-value":2},null,8,["modelValue"])])),_:1}),i(h,{label:"头像","label-width":"80px"},{default:r((()=>[o("div",{style:{display:"inline-block"},onClick:re},[de.value.headerImg?(l(),t("img",{key:0,alt:"头像",class:"header-img-box",src:de.value.headerImg&&"http"!==de.value.headerImg.slice(0,4)?Y.value+de.value.headerImg:de.value.headerImg},null,8,X)):(l(),t("div",Z,"从媒体库选择"))])])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["modelValue"]),i(z,{ref_key:"chooseImg",ref:ie,target:de.value,"target-key":"headerImg"},null,8,["target"])])}}});export{Y as default};
