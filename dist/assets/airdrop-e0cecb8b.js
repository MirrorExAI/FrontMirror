/*! 
 Build based on gin-vue-admin 
 Time : 1697152884000 */
import{a as e,X as a,o as l,c as t,b as o,d as r,w as i,g as s,t as u,G as d,h as m,e as p,aJ as n,aK as v,k as c,aL as g,l as h,E as y}from"./index-37934f2a.js";import{E as f}from"./dialog-71aa2b38.js";import"./overlay-93d44909.js";import{E as b}from"./switch-e92b670b.js";import{E as j}from"./radio-204c61f5.js";/* empty css              *//* empty css               */import"./tag-eed7c3b2.js";import"./checkbox-1e8f3d72.js";import"./scrollbar-b6c70f3e.js";import{E as _}from"./pagination-fb011907.js";import"./select-6545c62b.js";import{E as w,a as V}from"./table-column-b85be477.js";/* empty css                */import{a as I,E as k}from"./form-item-0ef09b87.js";/* empty css               */import{g as x}from"./authority-4c33df93.js";import"./image-viewer-4ea3a463.js";/* empty css                                                              */import{_ as N}from"./index-99ad2932.js";/* empty css             */import{f as z}from"./format-c3c2b764.js";import"./rand-099990c4.js";import"./strings-45cdd6ae.js";import"./isEqual-fd9c8814.js";import"./_Uint8Array-ba0cbfca.js";import"./cloneDeep-fe074834.js";import"./_baseClone-29c9b6f9.js";import"./_initCloneObject-8bdd6672.js";import"./index-fb5f2d1c.js";import"./index-f16bfdb4.js";import"./debounce-10f46826.js";import"./drawer-5d4a85a4.js";import"./common-25e920c5.js";import"./upload-0730a7ac.js";import"./progress-f49c0593.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./warningBar-582ed635.js";import"./date-225eaf4f.js";import"./dictionary-1667579d.js";import"./sysDictionary-22d05179.js";const C={class:"gva-search-box"},U={class:"gva-table-box"},E={class:"gva-pagination"},D={style:{height:"60vh",overflow:"auto",padding:"0 12px"}},S=["src"],q={key:1,class:"header-img-box"},A={class:"dialog-footer"},F={name:"User"},O=Object.assign(F,{setup(F){const O=e("https://api.bitcoin-wen.com/"),$=(e,a)=>{e&&e.forEach((e=>{if(e.children&&e.children.length){const l={authorityId:e.authorityId,authorityName:e.authorityName,children:[]};$(e.children,l.children),a.push(l)}else{const l={authorityId:e.authorityId,authorityName:e.authorityName};a.push(l)}}))},G=e(1),J=e(0),K=e(10),L=e([]);e([{value:0,text:""},{value:1,text:"正常"},{value:2,text:"冻结"}]);const X=e({}),Z=e=>{K.value=e,M()},B=e=>{G.value=e,M()},M=async()=>{const e=await n({page:G.value,pageSize:K.value,...X.value});0===e.code&&(L.value=e.data.list,J.value=e.data.total,G.value=e.data.page,K.value=e.data.pageSize)};a((()=>L.value),(()=>{P()}));(async()=>{M();const e=await x({page:1,pageSize:999});R(e.data.list)})();const P=()=>{L.value&&L.value.forEach((e=>{e.authorityIds=e.authorities&&e.authorities.map((e=>e.authorityId))}))},Y=e(null),H=()=>{Y.value.open()},Q=e([]),R=e=>{Q.value=[],$(e,Q.value)},T=e({username:"",password:"",nickName:"",headerImg:"",authorityId:"",authorityIds:[],enable:1}),W=e({userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,message:"最低5位字符",trigger:"blur"}],password:[{required:!0,message:"请输入用户密码",trigger:"blur"},{min:6,message:"最低6位字符",trigger:"blur"}],nickName:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],phone:[{pattern:/^1([38][0-9]|4[014-9]|[59][0-35-9]|6[2567]|7[0-8])\d{8}$/,message:"请输入合法手机号",trigger:"blur"}],email:[{pattern:/^([0-9A-Za-z\-_.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g,message:"请输入正确的邮箱",trigger:"blur"}],authorityId:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}),ee=e(null),ae=async()=>{T.value.authorityId=T.value.authorityIds[0],ee.value.validate((async e=>{if(e){const e={...T.value};if("add"===oe.value){const a=await v(e);0===a.code&&(c({type:"success",message:"请复制Google验证码：   "+a.data.user.googleSecret}),await M(),te())}if("edit"===oe.value){0===(await g(e)).code&&(c({type:"success",message:"编辑成功"}),await M(),te())}}}))},le=e(!1),te=()=>{ee.value.resetFields(),T.value.headerImg="",T.value.authorityIds=[],le.value=!1},oe=e("add"),re=()=>{X.value={}},ie=()=>{G.value=1,K.value=10,M()};return(e,a)=>{const n=h,v=I,c=y,g=k,x=w,F=V,$=_,M=j,P=b,R=f;return l(),t("div",null,[o("div",C,[r(g,{ref:"searchForm",inline:!0,model:X.value},{default:i((()=>[r(v,{align:"left",label:"开始日期",width:"180"},{default:i((()=>[r(n,{modelValue:X.value.startDate,"onUpdate:modelValue":a[0]||(a[0]=e=>X.value.startDate=e),type:"date",placeholder:"请选择开始日期"},null,8,["modelValue"])])),_:1}),r(v,{align:"left",label:"结束日期",width:"180"},{default:i((()=>[r(n,{modelValue:X.value.endDate,"onUpdate:modelValue":a[1]||(a[1]=e=>X.value.endDate=e),type:"date",placeholder:"请选择开始日期"},null,8,["modelValue"])])),_:1}),r(v,null,{default:i((()=>[r(c,{type:"primary",icon:"search",onClick:ie},{default:i((()=>[s("查询")])),_:1}),r(c,{icon:"refresh",onClick:re},{default:i((()=>[s("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),o("div",U,[r(F,{data:L.value,"row-key":"ID"},{default:i((()=>[r(x,{align:"left",label:"ID","min-width":"50",prop:"ID"}),r(x,{align:"left",label:"地址","min-width":"180",prop:"address"}),r(x,{align:"left",label:"金额","min-width":"180",prop:"reward"}),r(x,{align:"left",label:"创建日期","min-width":"150",sortable:"custom"},{default:i((e=>[s(u(d(z)(e.row.CreatedAt)),1)])),_:1})])),_:1},8,["data"]),o("div",E,[r($,{"current-page":G.value,"page-size":K.value,"page-sizes":[10,30,50,100],total:J.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:B,onSizeChange:Z},null,8,["current-page","page-size","total"])])]),r(R,{modelValue:le.value,"onUpdate:modelValue":a[9]||(a[9]=e=>le.value=e),title:"用户","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{footer:i((()=>[o("div",A,[r(c,{onClick:te},{default:i((()=>[s("取 消")])),_:1}),r(c,{type:"primary",onClick:ae},{default:i((()=>[s("确 定")])),_:1})])])),default:i((()=>[o("div",D,[r(g,{ref_key:"userForm",ref:ee,rules:W.value,model:T.value,"label-width":"80px"},{default:i((()=>["add"===oe.value?(l(),m(v,{key:0,label:"用户名",prop:"userName"},{default:i((()=>[r(n,{modelValue:T.value.userName,"onUpdate:modelValue":a[2]||(a[2]=e=>T.value.userName=e)},null,8,["modelValue"])])),_:1})):p("",!0),"add"===oe.value?(l(),m(v,{key:1,label:"密码",prop:"password"},{default:i((()=>[r(n,{modelValue:T.value.password,"onUpdate:modelValue":a[3]||(a[3]=e=>T.value.password=e)},null,8,["modelValue"])])),_:1})):p("",!0),r(v,{label:"昵称",prop:"nickName"},{default:i((()=>[r(n,{modelValue:T.value.nickName,"onUpdate:modelValue":a[4]||(a[4]=e=>T.value.nickName=e)},null,8,["modelValue"])])),_:1}),r(v,{label:"手机号",prop:"phone"},{default:i((()=>[r(n,{modelValue:T.value.phone,"onUpdate:modelValue":a[5]||(a[5]=e=>T.value.phone=e)},null,8,["modelValue"])])),_:1}),r(v,{label:"邮箱",prop:"email"},{default:i((()=>[r(n,{modelValue:T.value.email,"onUpdate:modelValue":a[6]||(a[6]=e=>T.value.email=e)},null,8,["modelValue"])])),_:1}),r(v,{label:"用户角色",prop:"authorityId"},{default:i((()=>[r(M,{modelValue:T.value.authorityIds,"onUpdate:modelValue":a[7]||(a[7]=e=>T.value.authorityIds=e),style:{width:"100%"},options:Q.value,"show-all-levels":!1,props:{multiple:!0,checkStrictly:!0,label:"authorityName",value:"authorityId",disabled:"disabled",emitPath:!1},clearable:!1},null,8,["modelValue","options"])])),_:1}),r(v,{label:"启用",prop:"disabled"},{default:i((()=>[r(P,{modelValue:T.value.enable,"onUpdate:modelValue":a[8]||(a[8]=e=>T.value.enable=e),"inline-prompt":"","active-value":1,"inactive-value":2},null,8,["modelValue"])])),_:1}),r(v,{label:"头像","label-width":"80px"},{default:i((()=>[o("div",{style:{display:"inline-block"},onClick:H},[T.value.headerImg?(l(),t("img",{key:0,alt:"头像",class:"header-img-box",src:T.value.headerImg&&"http"!==T.value.headerImg.slice(0,4)?O.value+T.value.headerImg:T.value.headerImg},null,8,S)):(l(),t("div",q,"从媒体库选择"))])])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["modelValue"]),r(N,{ref_key:"chooseImg",ref:Y,target:T.value,"target-key":"headerImg"},null,8,["target"])])}}});export{O as default};
